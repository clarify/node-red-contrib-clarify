<script type="text/javascript">
  (function () {
    RED.nodes.registerType('clarify_insert', {
      category: 'Clarify',
      color: '#00FF75',
      defaults: {
        name: {value: ''},
        apiRef: {value: null, type: 'clarify_api'},
        bufferTime: {
          value: '5',
          required: true,
          validate: function (v) {
            return RED.validators.number(v) && v >= 1;
          },
        },
        signalId: {
          value: 'payload.id',
          required: true,
        },
        signalName: {
          value: 'payload.name',
          required: true,
        },
        signalDataType: {
          value: 'payload.dataType',
          required: true,
        },
        signalDescription: {
          value: 'payload.description',
          required: true,
        },
        signalLabels: {
          value: 'payload.labels',
          required: true,
        },
        signalAnnotations: {
          value: 'payload.annotations',
          required: true,
        },
        signalEngUnit: {
          value: 'payload.engUnit',
          required: true,
        },
        signalEnumValues: {
          value: 'payload.enumValues',
          required: true,
        },
        signalSourceType: {
          value: 'payload.sourceType',
          required: true,
        },
        signalSampleInterval: {
          value: 'payload.sampleInterval',
          required: true,
        },
        signalGapDetection: {
          value: 'payload.gapDetection',
          required: true,
        },
        signalDataTimes: {
          value: 'payload.data.times',
          required: true,
        },
        signalDataSeries: {
          value: 'payload.data.series',
          required: true,
        },
        // Advanced settings
        alwaysEnsure: {
          value: false,
        },
      },
      inputs: 1,
      outputs: 2,
      icon: 'clarify.png',
      label: function () {
        return this.name || 'insert';
      },
      oneditprepare: function () {
        $('.msg-field').typedInput({
          default: 'msg',
          types: ['msg'],
        });

        $('#advanced-settings').hide();
        $('#advanced-settings-header').click(() => {
          if ($('#advanced-settings').is(':visible')) {
            $('#advanced-settings-caret').addClass('fa-caret-right').removeClass('fa-caret-down');
            $('#advanced-settings').hide();
          } else {
            $('#advanced-settings-caret').addClass('fa-caret-down').removeClass('fa-caret-right');
            $('#advanced-settings').show();
          }
        });
      },
    });
  })();
</script>

<script type="text/html" data-template-name="clarify_insert">
  <div class="form-row">
    <label for="node-input-name"><span data-i18n="clarify_insert.label.name"></label>
    <input type="text" id="node-config-input-name" data-i18n="[placeholder]clarify_insert.label.name" />
  </div>
  <div class="form-row">
    <label for="node-input-apiRef"><span data-i18n="clarify_insert.label.credentials"></label>
    <input type="text" id="node-input-apiRef" data-i18n="[placeholder]clarify_insert.label.credentials" />
  </div>
  <div class="form-row">
    <label for="node-input-bufferTime"><i class="fa fa-clock-o"></i> <span data-i18n="clarify_insert.label.bufferTime"></span></label>
    <input type="number" id="node-input-bufferTime" min="1" style="text-align:end; width:100px !important">
    <label for="label"><span data-i18n="clarify_insert.label.secs"></label>
  </div>
  <div class="form-row">
    <h4 style="cursor: pointer;" id="advanced-settings-header">
      <i class="fa fa-caret-right" id="advanced-settings-caret"></i>
      <span data-i18n="clarify_insert.header.advancedSettings">
    </h4>
  </div>
  <div id="advanced-settings">
    <div class="form-row">
      <label for="node-input-alwaysEnsure"><span data-i18n="clarify_insert.label.alwaysEnsure"></label>
      <input type="checkbox" id="node-input-alwaysEnsure" />
    </div>
    <div class="form-row">
      <label for="node-input-signalId"><span data-i18n="clarify_insert.label.id"></label>
      <input type="text" class="msg-field" id="node-input-signalId" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalName"><span data-i18n="clarify_insert.label.name"></label>
      <input type="text" class="msg-field" id="node-input-signalName" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalDataType"><span data-i18n="clarify_insert.label.dataType"></label>
      <input type="text" class="msg-field" id="node-input-signalDataType" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalDescription"><span data-i18n="clarify_insert.label.description"></label>
      <input type="text" class="msg-field" id="node-input-signalDescription" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalLabels"><span data-i18n="clarify_insert.label.labels"></label>
      <input type="text" class="msg-field" id="node-input-signalLabels" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalAnnotations"><span data-i18n="clarify_insert.label.annotations"></label>
      <input type="text" class="msg-field" id="node-input-signalAnnotations" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalEngUnit"><span data-i18n="clarify_insert.label.engUnit"></label>
      <input type="text" class="msg-field" id="node-input-signalEngUnit" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalEnumValues"><span data-i18n="clarify_insert.label.enumValues"></label>
      <input type="text" class="msg-field" id="node-input-signalEnumValues" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalSourceType"><span data-i18n="clarify_insert.label.sourceType"></label>
      <input type="text" class="msg-field" id="node-input-signalSourceType" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalSampleInterval"><span data-i18n="clarify_insert.label.sampleInterval"></label>
      <input type="text" class="msg-field" id="node-input-signalSampleInterval" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalGapDetection"><span data-i18n="clarify_insert.label.gapDetection"></label>
      <input type="text" class="msg-field" id="node-input-signalGapDetection" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalDataTimes"><span data-i18n="clarify_insert.label.dataTimes"></label>
      <input type="text" class="msg-field" id="node-input-signalDataTimes" style="width:70%" />
    </div>
    <div class="form-row">
      <label for="node-input-signalDataSeries"><span data-i18n="clarify_insert.label.dataSeries"></label>
      <input type="text" class="msg-field" id="node-input-signalDataSeries" style="width:70%" />
    </div>
  </div>
</script>
